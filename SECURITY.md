# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Simple Bookkeepingãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨è¨­å®šæ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ” ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

### å¿…é ˆã®ç’°å¢ƒå¤‰æ•°

ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã¯**å¿…ãš**è¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# JWTç½²åç”¨ã®ç§˜å¯†éµï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯64æ–‡å­—ä»¥ä¸Šã®ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ï¼‰
JWT_SECRET=your-64-character-random-string-here
JWT_REFRESH_SECRET=your-different-64-character-random-string-here

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ–‡å­—åˆ—ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯å¼·ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ï¼‰
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
```

### ğŸ² å®‰å…¨ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã®ç”Ÿæˆ

#### Node.jsä½¿ç”¨

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

#### OpenSSLä½¿ç”¨

```bash
openssl rand -hex 32
```

#### Pythonä½¿ç”¨

```bash
python -c "import secrets; print(secrets.token_hex(32))"
```

## âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å‰

- [ ] JWT_SECRETã¨JWT_REFRESH_SECRETãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¼·åŠ›ã§ã‚ã‚‹
- [ ] .envãƒ•ã‚¡ã‚¤ãƒ«ãŒGitã«ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ãªã„
- [ ] NODE_ENVãŒproductionã«è¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] HTTPSãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹

### é–‹ç™ºç’°å¢ƒ

- [ ] ãƒ†ã‚¹ãƒˆç”¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] .env.exampleã«ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã®ã¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] æœ¬ç•ªç”¨ã®ç§˜å¯†éµãŒã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„

## ğŸš« ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨

### âŒ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸç§˜å¯†æƒ…å ±

```typescript
// âŒ æ‚ªã„ä¾‹
const secret = 'hardcoded-secret-key';

// âœ… è‰¯ã„ä¾‹
const secret = process.env.JWT_SECRET;
if (!secret) {
  throw new Error('JWT_SECRET environment variable is required');
}
```

### âŒ å¼±ã„ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰

```typescript
// âŒ æ‚ªã„ä¾‹
const password = 'password123';

// âœ… è‰¯ã„ä¾‹
const password = process.env.TEST_PASSWORD || generateRandomPassword();
```

### âŒ æœ¬ç•ªç’°å¢ƒã§ã®å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰

```typescript
// âŒ æ‚ªã„ä¾‹
console.log('Password:', plainPassword);

// âœ… è‰¯ã„ä¾‹ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰
if (process.env.NODE_ENV === 'development') {
  console.log('Generated test password:', testPassword);
}
```

## ğŸ”’ èªè¨¼ãƒ»èªå¯

### JWTè¨­å®š

- **æœ‰åŠ¹æœŸé™**: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³1æ™‚é–“ã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³7æ—¥
- **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: HS256ï¼ˆHMAC with SHA-256ï¼‰
- **ç½²åæ¤œè¨¼**: ã™ã¹ã¦ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§å¿…é ˆ

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥

- **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: bcrypt
- **ã‚½ãƒ«ãƒˆãƒ©ã‚¦ãƒ³ãƒ‰**: 10ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰ã€12ä»¥ä¸Šï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰

## ğŸ›¡ï¸ ãƒ‡ãƒ¼ã‚¿ä¿è­·

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- PostgreSQLæ¥ç¶šã¯SSLå¿…é ˆï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
- æœ€å°æ¨©é™ã®åŸå‰‡ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
- å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### API

- CORSè¨­å®šã®é©åˆ‡ãªåˆ¶é™
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ï¼ˆPrisma ORMä½¿ç”¨ï¼‰

## ğŸ“‹ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

### å®šæœŸãƒã‚§ãƒƒã‚¯é …ç›®

1. ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³

   ```bash
   pnpm audit
   ```

2. ç§˜å¯†æƒ…å ±ã®æ¼æ´©ãƒã‚§ãƒƒã‚¯

   - GitGuardianãªã©ã®ãƒ„ãƒ¼ãƒ«ä½¿ç”¨
   - ã‚³ãƒŸãƒƒãƒˆå‰ã®pre-commit hook

3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç¢ºèª
   - helmet.jsã®ä½¿ç”¨
   - HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

## ğŸ”§ é–‹ç™ºè€…å‘ã‘è¨­å®š

### Gitè¨­å®š

```bash
# .gitignore ã§ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤–
echo ".env" >> .gitignore
echo ".env.local" >> .gitignore
```

### Pre-commit Hook

```bash
# secretsæ¤œå‡º
pnpm add -D @commitlint/cli @commitlint/config-conventional
```

## ğŸ“ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

### å ±å‘Šæ‰‹é †

1. å³åº§ã«é–‹ç™ºãƒãƒ¼ãƒ ã«é€£çµ¡
2. å½±éŸ¿ç¯„å›²ã®ç‰¹å®š
3. ä¸€æ™‚çš„ãªä¿®æ­£ã®å®Ÿæ–½
4. æ ¹æœ¬åŸå› ã®åˆ†æã¨æ’ä¹…å¯¾ç­–

### ç·Šæ€¥å¯¾å¿œ

- JWTç§˜å¯†éµã®æ¼æ´©: å³åº§ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æƒ…å ±ã®æ¼æ´©: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã¨ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- APIã‚­ãƒ¼ã®æ¼æ´©: ç„¡åŠ¹åŒ–ã¨å†ç”Ÿæˆ

## ğŸ“š å‚è€ƒè³‡æ–™

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)
- [JWT Best Practices](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-jwt-bcp-07)
