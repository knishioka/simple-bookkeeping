# Subagent Communication Protocol v1.0
# SuperClaude式の構造化出力プロトコル

Protocol_Version: '1.0'

## Output_Structure
Output_Format:
  Status: 'SUCCESS|FAIL|WARNING|HALLUCINATION'
  Data: 'Structured JSON data'
  Verification: 'checksum|timestamp|source'
  Evidence: 'api_response|command_output'

Required_Sections:
  Protocol_Markers:
    Start: '===PROTOCOL_START==='
    End: '===PROTOCOL_END==='
  Data_Markers:
    Start: '===DATA_START==='
    End: '===DATA_END==='
  Evidence_Markers:
    Start: '===EVIDENCE_START==='
    End: '===EVIDENCE_END==='

Status_Codes:
  SUCCESS: 'Operation completed successfully with verified data'
  FAIL: 'Operation failed with error - no data available'
  WARNING: 'Operation completed with warnings - verify data carefully'
  HALLUCINATION: 'Detected potential hallucination - data rejected'

## Validation_Requirements
Validation_Layers:
  Layer_1_Format:
    Description: 'Protocol format validation'
    Checks:
      - 'Required markers present'
      - 'Status code valid'
      - 'Timestamp format correct'

  Layer_2_Integrity:
    Description: 'Data integrity validation'
    Checks:
      - 'JSON parse successful'
      - 'Checksum verification'
      - 'Required fields present'

  Layer_3_External:
    Description: 'External source validation'
    Checks:
      - 'Direct API verification'
      - 'Cross-reference validation'
      - 'Hallucination detection'

## Data_Format
Required_Fields:
  metadata:
    timestamp: 'ISO 8601 format'
    source: 'Data source identifier'
    checksum: 'SHA256 of data content'
    verified: 'boolean'

  data:
    Description: 'Actual response data in JSON'
    Format: 'Service-specific structure'

  evidence:
    raw_command: 'Executed command'
    raw_response: 'Unmodified API response'
    verification_steps: 'Array of validation steps performed'

## Example_Output
Example: |
  ===PROTOCOL_START===
  STATUS: SUCCESS
  TIMESTAMP: 2025-01-02T10:00:00Z
  COMMAND: gh issue view 317 --repo user/repo
  CHECKSUM: sha256:abc123...

  ===DATA_START===
  {
    "issue_number": "317",
    "title": "Actual title from API",
    "verification": {
      "source": "github_api",
      "verified": true
    }
  }
  ===DATA_END===

  ===EVIDENCE_START===
  RAW_RESPONSE: {"number": 317, "title": "..."}
  VALIDATION_STEPS: ["api_call", "checksum", "external_verify"]
  ===EVIDENCE_END===

  ===PROTOCOL_END===

## Error_Handling
Error_Response: |
  ===PROTOCOL_START===
  STATUS: FAIL
  ERROR: "Detailed error message"
  TIMESTAMP: 2025-01-02T10:00:00Z
  ===PROTOCOL_END===

## Implementation_Notes
Best_Practices:
  - 'Always include evidence for verification'
  - 'Never generate data from memory'
  - 'Fail fast on validation errors'
  - 'Log all validation steps'
  - 'Use consistent timestamp format'
