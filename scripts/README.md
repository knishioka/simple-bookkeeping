# Scripts Documentation

## æ¦‚è¦

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€Simple Bookkeepingãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºãƒ»é‹ç”¨ã‚’æ”¯æ´ã™ã‚‹å„ç¨®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ç‰¹å®šã®ç›®çš„ã‚’æŒã¡ã€é–‹ç™ºãƒ•ãƒ­ãƒ¼ã®è‡ªå‹•åŒ–ã¨åŠ¹ç‡åŒ–ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
scripts/
â”œâ”€â”€ db/                     # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£SQLã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ sql/               # SQLãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ lib/                   # å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â””â”€â”€ config.sh         # å…±é€šè¨­å®š
â”œâ”€â”€ *.sh                   # ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ *.js                   # Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ *.ts                   # TypeScriptã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸš€ ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç›£è¦–

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ             | ç”¨é€”                                                | ä½¿ç”¨ä¾‹                             |
| ---------------------- | --------------------------------------------------- | ---------------------------------- |
| `check-deployments.sh` | Vercel/Renderã®ä¸¡ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ…‹ç¢ºèª | `./scripts/check-deployments.sh`   |
| `render-logs.sh`       | Renderã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°å–å¾—ï¼ˆruntime/build/errorsï¼‰    | `./scripts/render-logs.sh runtime` |
| `vercel-logs.sh`       | Vercelãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®ãƒ­ã‚°å–å¾—                      | `./scripts/vercel-logs.sh build`   |
| `render-api-status.sh` | Render APIã‚’ä½¿ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª                | `./scripts/render-api-status.sh`   |
| `vercel-api-status.sh` | Vercel APIã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ç¢ºèª          | `./scripts/vercel-api-status.sh`   |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ             | ç”¨é€”                                                                   | ä½¿ç”¨ä¾‹                           |
| ---------------------- | ---------------------------------------------------------------------- | -------------------------------- |
| `init-db.sh`           | ãƒ­ãƒ¼ã‚«ãƒ«DBã®åˆæœŸåŒ–ï¼ˆPrismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚·ãƒ¼ãƒ‰ï¼‰ | `./scripts/init-db.sh`           |
| `migrate-render-db.sh` | Renderç’°å¢ƒã®DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ                                     | `./scripts/migrate-render-db.sh` |
| `seed-render-db.sh`    | Renderç’°å¢ƒã®DBã¸ã®ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥                                     | `./scripts/seed-render-db.sh`    |

### ãƒ“ãƒ«ãƒ‰ãƒ»å“è³ªãƒã‚§ãƒƒã‚¯

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ            | ç”¨é€”                                                      | ä½¿ç”¨ä¾‹                          |
| --------------------- | --------------------------------------------------------- | ------------------------------- |
| `check-full-build.sh` | Vercel/Renderä¸¡æ–¹ã®å®Œå…¨ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ï¼ˆpre-pushãƒ•ãƒƒã‚¯ç”¨ï¼‰ | `./scripts/check-full-build.sh` |
| `check-build.sh`      | ãƒ“ãƒ«ãƒ‰å¯èƒ½æ€§ã®ç¢ºèª                                        | `./scripts/check-build.sh`      |

### é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ       | ç”¨é€”                               | ä½¿ç”¨ä¾‹                        |
| ---------------- | ---------------------------------- | ----------------------------- |
| `setup-local.sh` | ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã®åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | `./scripts/setup-local.sh`    |
| `start-dev.sh`   | é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•                 | `./scripts/start-dev.sh`      |
| `check-ports.js` | ä½¿ç”¨ãƒãƒ¼ãƒˆã®ç¢ºèªï¼ˆ3000/3001ï¼‰      | `node scripts/check-ports.js` |

### ãƒ†ã‚¹ãƒˆé–¢é€£

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ            | ç”¨é€”                   | ä½¿ç”¨ä¾‹                             |
| --------------------- | ---------------------- | ---------------------------------- |
| `e2e-test.sh`         | E2Eãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ        | `./scripts/e2e-test.sh`            |
| `e2e-basic-test.js`   | åŸºæœ¬çš„ãªE2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ  | `node scripts/e2e-basic-test.js`   |
| `create-test-user.js` | ãƒ†ã‚¹ãƒˆç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆ | `node scripts/create-test-user.js` |

### ç’°å¢ƒè¨­å®š

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ          | ç”¨é€”                     | ä½¿ç”¨ä¾‹                        |
| ------------------- | ------------------------ | ----------------------------- |
| `validate-env.ts`   | ç’°å¢ƒå¤‰æ•°ã®å¦¥å½“æ€§æ¤œè¨¼     | `tsx scripts/validate-env.ts` |
| `render-env-set.sh` | Renderç’°å¢ƒã®ç’°å¢ƒå¤‰æ•°è¨­å®š | `./scripts/render-env-set.sh` |

### ãã®ä»–ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ               | ç”¨é€”                                 | ä½¿ç”¨ä¾‹                             |
| ------------------------ | ------------------------------------ | ---------------------------------- |
| `update-to-singapore.sh` | Renderãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã«æ›´æ–° | `./scripts/update-to-singapore.sh` |

## ğŸ”§ ç’°å¢ƒå¤‰æ•°

å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å¿…è¦ãªç’°å¢ƒå¤‰æ•°ï¼š

| ç’°å¢ƒå¤‰æ•°         | èª¬æ˜                               | å¿…é ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ           |
| ---------------- | ---------------------------------- | ------------------------ |
| `DATABASE_URL`   | PostgreSQLæ¥ç¶šæ–‡å­—åˆ—               | DBé–¢é€£ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¨èˆ¬     |
| `RENDER_API_KEY` | Render APIã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼             | `render-*.sh`            |
| `VERCEL_TOKEN`   | Vercelèªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³                 | `vercel-*.sh`            |
| `NODE_ENV`       | å®Ÿè¡Œç’°å¢ƒï¼ˆdevelopment/productionï¼‰ | ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ |

### ç’°å¢ƒå¤‰æ•°ã®è¨­å®šæ–¹æ³•

```bash
# .env.localãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰
RENDER_API_KEY=rnd_xxxxxxxxxxxx
VERCEL_TOKEN=xxxxxxxxxxxx
DATABASE_URL=postgresql://user:password@localhost:5432/simple_bookkeeping

# ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ç›´æ¥è¨­å®š
export RENDER_API_KEY=rnd_xxxxxxxxxxxx
```

## ğŸ“ ä½¿ç”¨ä¾‹

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆçŠ¶æ…‹ã®ç¢ºèª

```bash
# ä¸¡ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ä¸€åº¦ã«ç¢ºèª
./scripts/check-deployments.sh

# Renderã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ­ã‚°ã‚’ç¢ºèª
./scripts/render-logs.sh runtime

# Vercelã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèª
./scripts/vercel-logs.sh build
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®DBåˆæœŸåŒ–
./scripts/init-db.sh

# Renderç’°å¢ƒã®DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
./scripts/migrate-render-db.sh
```

### ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯

```bash
# pushå‰ã®å®Œå…¨ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
./scripts/check-full-build.sh

# ç°¡æ˜“ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
./scripts/check-build.sh
```

## ğŸ—ï¸ SQLã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆdb/sql/ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ«                   | ç”¨é€”                           |
| -------------------------- | ------------------------------ |
| `check-render-db.sql`      | Render DBã®æ¥ç¶šç¢ºèªç”¨SQL       |
| `fix-failed-migration.sql` | å¤±æ•—ã—ãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¿®å¾© |
| `init-render-db.sql`       | Render DBã®åˆæœŸåŒ–              |
| `insert-accounts.sql`      | å‹˜å®šç§‘ç›®ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥     |
| `reset-render-db.sql`      | Render DBã®ãƒªã‚»ãƒƒãƒˆï¼ˆé–‹ç™ºç”¨ï¼‰  |

## âš ï¸ æ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- APIã‚­ãƒ¼ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã¯çµ¶å¯¾ã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
- ç’°å¢ƒå¤‰æ•°ã¯`.env.local`ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ç®¡ç†
- æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿè¡Œæ™‚ã¯ç‰¹ã«æ³¨æ„

### å®Ÿè¡Œæ¨©é™

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x scripts/*.sh
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

- å…¨ã¦ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯`set -e`ã§å³åº§ã«ã‚¨ãƒ©ãƒ¼çµ‚äº†
- é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™
- ãƒ­ã‚°å‡ºåŠ›ã§å•é¡Œã®ç‰¹å®šã‚’å®¹æ˜“ã«

## ğŸ”„ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ æ™‚

1. ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
2. ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã§ç›®çš„ãƒ»ä½¿ç”¨æ–¹æ³•ã‚’æ˜è¨˜
3. ã“ã®READMEã«è¿½åŠ 
4. å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
5. å¿…è¦ã«å¿œã˜ã¦package.jsonã«npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ 

### æ—¢å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ›´æ–°æ™‚

1. å¤‰æ›´å†…å®¹ã‚’ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«æ˜è¨˜
2. ç ´å£Šçš„å¤‰æ›´ã®å ´åˆã¯å½±éŸ¿ç¯„å›²ã‚’ç¢ºèª
3. READMEã®è©²å½“ç®‡æ‰€ã‚’æ›´æ–°

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [npm scripts guide](../docs/npm-scripts-guide.md) - npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è©³ç´°
- [Deployment guide](../docs/deployment/) - ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ‰‹é †
- [Environment variables](../docs/ENVIRONMENT_VARIABLES.md) - ç’°å¢ƒå¤‰æ•°ã®è©³ç´°
- [Docker setup](../docs/docker-setup.md) - Dockerç’°å¢ƒæ§‹ç¯‰

## ğŸ†˜ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã§ããªã„

```bash
# å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x scripts/script-name.sh
```

#### ç’°å¢ƒå¤‰æ•°ãŒèªè­˜ã•ã‚Œãªã„

```bash
# ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
echo $RENDER_API_KEY

# .env.localã‹ã‚‰èª­ã¿è¾¼ã¿
source .env.local
```

#### ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­

```bash
# ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
lsof -i :3000
lsof -i :3001

# ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill -9 <PID>
```

è©³ç´°ã¯[ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](../docs/deployment/troubleshooting.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
